// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model User {
  id          Int          @id @default(autoincrement())
  email       String       @unique
  password    String
  foodForests FoodForest[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @default(now()) @updatedAt
  deletedAt   DateTime?
  messages    Messages[]
}

model FoodForest {
  id        Int                 @id @default(autoincrement())
  name      String
  location  String
  image     String?             @db.MediumText
  owner     User?               @relation(fields: [ownerId], references: [id])
  ownerId   Int?
  plants    Plant[]
  createdAt DateTime            @default(now())
  updatedAt DateTime            @default(now()) @updatedAt
  deletedAt DateTime?
  messages  Messages[]
}

model Species {
  id              Int                 @id @default(autoincrement())
  name            String
  description     String?
  type            String?
  scientificName  String?
  harvestSeason   String?
  sunRequirement  String?
  waterNeeds      String?
  maintenance     String?
  plants          Plant[]
  minTemperature  Float?
  maxTemperature  Float?
  minHumidity     Float?
  maxHumidity     Float?
  minSoilPH       Float?
  maxSoilPH       Float?
  minSoilMoisture Float?
  maxSoilMoisture Float?
  minSunlight     Float?
  maxSunlight     Float?
  image           String?             @db.MediumText
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @default(now()) @updatedAt
  deletedAt       DateTime?
}

model Plant {
  id                Int         @id @default(autoincrement())
  stage             String?
  harvestPrediction String?
  species           Species     @relation(fields: [speciesId], references: [id])
  speciesId         Int
  foodForest        FoodForest  @relation(fields: [foodForestId], references: [id])
  foodForestId      Int
  conditions        Conditions[]
  height            String?
  image             String?     @db.MediumText
  posX              Float       @default(0)
  posY              Float       @default(0)
  lastInspected     DateTime?
  plantHealth       String?
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @default(now()) @updatedAt
  deletedAt         DateTime?
}

model Conditions {
  plant        Plant    @relation(fields: [plantId], references: [id])
  plantId      Int
  temperature  Float?
  humidity     Float?
  soilPH       Float?
  soilMoisture Float?
  sunlight     Float?
  status       String?
  createdAt    DateTime @default(now())
  
  @@id([createdAt, plantId])
}

model Messages {
  user         User       @relation(fields: [userId], references: [id])
  userId       Int
  foodForest   FoodForest @relation(fields: [foodForestId], references: [id])
  foodForestId Int
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @default(now()) @updatedAt
  deletedAt    DateTime?
  message      String
  image        String?    @db.MediumText

  @@id([userId, foodForestId, createdAt])
}
