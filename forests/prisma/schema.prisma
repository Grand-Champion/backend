// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
}

model User {
  id          Int          @id @default(autoincrement())
  email       String
  password    String
  foodForests FoodForest[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @default(now()) @updatedAt
  deletedAt   DateTime?
}

model FoodForest {
  id        Int                 @id @default(autoincrement())
  name      String
  location  String
  image     String?
  owner     User?               @relation(fields: [ownerId], references: [id])
  ownerId   Int?
  plants    Plant[]
  species   FoodForestSpecies[]
  createdAt DateTime            @default(now())
  updatedAt DateTime            @default(now()) @updatedAt
  deletedAt DateTime?
}

model FoodForestSpecies {
  foodForest   FoodForest @relation(fields: [foodForestId], references: [id])
  foodForestId Int
  species      Species    @relation(fields: [speciesId], references: [id])
  speciesId    Int

  plants Plant[]

  @@id([foodForestId, speciesId])
}

model Species {
  id              Int                 @id @default(autoincrement())
  name            String
  description     String?
  type            String?
  scientificName  String?
  harvestSeason   String?
  sunRequirement  String?
  waterNeeds      String?
  maintenance     String?
  plants          Plant[]
  minTemperature  Float?
  maxTemperature  Float?
  minHumidity     Float?
  maxHumidity     Float?
  minSoilPH       Float?
  maxSoilPH       Float?
  minSoilMoisture Float?
  maxSoilMoisture Float?
  minSunlight     Float?
  maxSunlight     Float?
  image           String?
  foodForests     FoodForestSpecies[]
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @default(now()) @updatedAt
  deletedAt       DateTime?
}

model Plant {
  id                Int         @id @default(autoincrement())
  stage             String?
  harvestPrediction String?
  species           Species     @relation(fields: [speciesId], references: [id])
  speciesId         Int
  foodForest        FoodForest  @relation(fields: [foodForestId], references: [id])
  foodForestId      Int
  conditions        Conditions?
  height            String?
  image             String?
  posX              Float       @default(0)
  posY              Float       @default(0)
  plantStage        String?
  lastInspected     DateTime?
  plantHealth       String?
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @default(now()) @updatedAt
  deletedAt         DateTime?

  foodForestSpecies FoodForestSpecies @relation(fields: [foodForestId, speciesId], references: [foodForestId, speciesId])
}

model Conditions {
  plant        Plant    @relation(fields: [plantId], references: [id])
  plantId      Int      @id
  temperature  Float?
  humidity     Float?
  soilPH       Float?
  soilMoisture Float?
  sunlight     Float?
  status       String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @default(now()) @updatedAt
}

model Messages {
  user        User        @relation(fields: [userId], references: [id])
  userId      Int         @id
  foodForest  FoodForest  @relation(fields: [foodForestId], references: [id])
  foodForestId  FoodForest  @id
  createdAt   DateTime @default(now())
  message     String
  image       String?
}